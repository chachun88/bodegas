{% extends "../base.html" %}

{% block title %}Entradas Masivas {% end %}

{% block caption %} 
	{% if int(2) in current_user.permissions %}
	 permite cargar un archivo excel
	{% else %}
	 sección no autorizada
	{% end %}
{% end %}

{% block body %}
{% if int(2) in current_user.permissions %}
<div class="loader animated fadeIn">
	<span class="spinner" style="top:30%; font-size: 40px;">
		<i id="load" class="fa-spinner fa-spin"></i>
	</span>
</div>
{% if dn == "t" %}
<div class="alert alert-success alert-success-nohidden">
	<button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
	<strong><i class="fa fa-check"></i> Bien hecho!</strong> Se ha cargado excel correctamente.
</div>
{% end %}
{% if dn == "t2" %}
<div class="alert alert-warning alert-success-nohidden">
	<button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
	<strong><i class="fa fa-check"></i> No se ha cargado excel!</strong> Debe cargar excel antes de subir archivo.
</div>
{% end %}
{% if dn == "t3" %}
<div class="alert alert-warning alert-success-nohidden">
	<button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
	<strong><i class="fa fa-check"></i> Excel erroneo!</strong> Excel contiene errores.
</div>
{% end %}
{% for x in w %}
<div class="alert alert-warning alert-success-nohidden">
	<button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
	<strong><i class="fa fa-check"></i> Alerta!</strong> {{ x }}.
</div>
{% end %}
<div class="col-md-12">
	<section class="widget">
		<form enctype="multipart/form-data" action="" method="post">
			<div class="form-actions fileupload-buttonbar no-margin" action="/" method="post" enctype="multipart/form-data">
				<span class="btn btn-sm btn-default fileinput-button">
					<i class="fa fa-plus"></i>
					<span>Cargar excel...</span>
					<input type="file" name="file" multiple="">
				</span>
				<button type="submit" class="btn btn-primary btn-sm start">
					<i class="fa fa-upload"></i>
					<span>Subir Archivo</span>
				</button>
				<button type="reset" class="btn btn-inverse btn-sm cancel">
					<i class="fa fa-ban"></i>
					<span>Cancelar</span>
				</button>
			</div>
			{% raw xsrf_form_html() %}
		</form>
		<form enctype="multipart/form-data" action="/product/load" method="post">
			<div class="load-products form-actions fileupload-buttonbar no-margin">
				<button type="submit" class="btn btn-primary btn-sm start">
					<i class="fa fa-upload"></i>
					<span>Cargar productos</span>
				</button>
			</div>
			{% raw xsrf_form_html() %}
		</form>

		<div class="body">
			<table class="table table-striped table-images">
				<thead>
					<tr>
						{% try %}
							{% for j in range(ncols) %} 
								<th class="sorting" >{{matriz[3][j]}}</th>
							{% end %}
						{% except %}
						{% end %}
					</tr>
				</thead>
				<tbody>
					{% try %}
						{% for i in range(4, nrows) %}
							<tr>
							{% for j in range(ncols) %}
								<td class="hidden-xs-portrait">{{matriz[i][j]}}</td>
							{% end %}	
							</tr>
						{% end %}
					{% except %}
					{% end %}	
				</tbody>
			</table>
		</div>
	</section>
</div>
{% else %}
<div class="col-md-12">
	<section class="widget">
		<div style="float:right;">
		</div>
	</section>
</div>
{% end %}
{% end %}