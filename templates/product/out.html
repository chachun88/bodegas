{% extends "../base.html" %}

{% block title %}Carga Masiva productos {% end %}
{% block caption %} puedes cargar un excel con una lista de productos{% end %}

{% block body %}
{% if args["dn"].encode("utf-8") == "t" %}
<div class="alert alert-success alert-success-nohidden">
	<button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
	<strong><i class="fa fa-check"></i> Bien hecho!</strong> Se ha cargado excel correctamente.
</div>
{% end %}
{% if args["dn"].encode("utf-8") == "t2" %}
<div class="alert alert-warning">
	<button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
	<strong><i class="fa fa-check"></i> No se ha cargado excel!</strong> Debe cargar excel antes de subir archivo.
</div>
{% end %}
{% for w in args["warnings"] %}
<div class="alert alert-warning">
	<button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
	<strong><i class="fa fa-check"></i> No se ha cargado excel!</strong>{{w}}
</div>
{% end %}
<div class="col-md-12">
	<section class="widget">
		<p>
			<a class="btn btn-sm btn-primary" href="/static/productos.xlsx">Descargar plantilla</a>
		</p>
		<form enctype="multipart/form-data" action="" method="post">
			<div class="form-actions fileupload-buttonbar no-margin" action="/" method="post" enctype="multipart/form-data">
				<span class="btn btn-sm btn-default fileinput-button">
					<i class="fa fa-plus"></i>
					<span>Cargar excel...</span>
					<input type="file" name="file" multiple="">
				</span>
				<button type="submit" class="btn btn-primary btn-sm start">
					<i class="fa fa-upload"></i>
					<span>Subir Archivo</span>
				</button>
				<button type="reset" class="btn btn-inverse btn-sm cancel">
					<i class="fa fa-ban"></i>
					<span>Cancelar</span>
				</button>
			</div>
			{% raw xsrf_form_html() %}
		</form>
		<form enctype="multipart/form-data" action="/product/load" method="post">
			<div class="form-actions fileupload-buttonbar no-margin">
				<input type="hidden" name="filename" value="{{args["filename"]}}">
				<input type="hidden" name="dn" value="{{args['dn']}}">
				<button type="submit" class="btn btn-primary btn-sm start">
					<i class="fa fa-upload"></i>
					<span>Cargar productos</span>
				</button>
			</div>
			{% raw xsrf_form_html() %}
		</form>

		<div class="body">
			<table class="table table-striped table-images">
				<thead>
					<tr>
						{% try %}
							{% for j in range(args["ncols"]) %} 
								<th>{{args["matriz"][0][j]}}</th>
							{% end %}
						{% except %}
						{% end %}
					</tr>
				</thead>
				<tbody>
					{% try %}
						{% for i in range(1, args["nrows"]) %}
							<tr>
							{% for j in range(args["ncols"]) %}
								<td class="hidden-xs-portrait">{{args["matriz"][i][j]}}</td>
							{% end %}	
							</tr>
						{% end %}
					{% except %}
					{% end %}	
				</tbody>
			</table>
		</div>
	</section>
</div>

{% end %}